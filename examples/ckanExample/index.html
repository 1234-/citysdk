<!DOCTYPE html>
<html>
<head>
    <title>New York City Day Care Center Locations</title>
    <script src="../libraries/vendor/jquery/jquery-2.1.3.min.js" type="text/javascript"></script>
    <script src="../../js/citysdk.js" type="text/javascript"></script>
    <script src="../../js/citysdk.ckan.js" type="text/javascript"></script>

    <script>
        var sdk, ckan;

        $(document).ready(function() {
            sdk = new CitySDK();
            ckan = sdk.modules.ckan;
        });

        function submit() {
            var request = {
                "url": "catalog.opendata.city",
                "resource": "e4491e0c-ba09-4cb2-97c1-d466e3e976a5"
            }

            var where = $('#where');
            if (where.val().length > 0) {
                request.where = where.val();
            }

            var select = $('#select');
            if (select.val().length > 0) {
                request.select = select.val();
            }

            var orderBy = $('#orderBy');
            if (orderBy.val().length > 0) {
                request.orderBy = orderBy.val();
            }

            var limit = $('#limit');
            if (limit.val().length > 0) {
                request.limit = limit.val();
            }

            ckan.request(request, function(response) {
                var output = $('#output');
                output.empty();

                if (response.success) {
                    response.result.records.forEach(function(entry) {
                        for (var property in entry) {
                            if (entry.hasOwnProperty(property)) {
                                output.append("<b>" + property + "</b>: " + entry[property] + "; ");
                            }
                        }
                        output.append("<br/>");
                    });
                }
            });
        }
    </script>
</head>
<body>
<div>
    <h2>New York City Day Care Center Locations</h2>
    <p>Fields: name, HOUSENUM, STREETNAME, postalCode, streetAddress, BIN, BBL, addressLocality, loc, longitude, latitude, URL</p>
    <p>Try out some clauses (leave blank to ignore):</p>
    <p>Select: <input id="select" style="width: 200px;" type="text"/> (i.e. "name","streetAddress","postalCode") Default * </p>
    <p>Where: <input id="where" style="width: 200px;" type="text"/> (i.e. "postalCode" = '10001' or "postalCode" = '10012')</p>
    <p>Order By: <input id="orderBy" style="width: 200px;" type="text"/> (i.e. "postalCode")</p>
    <p>Limit: <input id="limit" style="width: 200px;" type="text"/> (i.e. 25) Default 1000</p>
    <input type="submit" onclick="submit()" value="Query"/>
</div>
<pre id="output">

</pre>
</body>
</html>
