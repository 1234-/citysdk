---
layout: guideslayout
published: true
---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../font-awesome/css/font-awesome.min.css">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <title>City SDK Guides: Using Multiple Modules</title>

    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=visualization&signed_in=true">
    </script>

    <script src="https://cdn.rawgit.com/uscensusbureau/citysdk/Release1.1/js/citysdk.js"></script>
    <script src="https://cdn.rawgit.com/uscensusbureau/citysdk/Release1.1/js/citysdk.census.js"></script>
    <script src="https://cdn.rawgit.com/uscensusbureau/citysdk/Release1.1/js/citysdk.farmersMarket.js"></script>

    <script>
        var apiKey, map;

        var sdk = new CitySDK();
        var census = sdk.modules.census;
        var farmersMarket = sdk.modules.farmersMarket;

        //We won't need API keys for just Geography.
        census.enable("");

        function clearMap() {
            map.data.forEach(function(feature) {
                map.data.remove(feature);
            });
        };

        function runExample(id) {
            clearMap();
            var textarea = $('#' + id);

            eval(textarea.val());
        };

        $(document).ready(
                function() {
                    var mapOptions = {
                        center: { lat: 37, lng: -120},
                        zoom: 6
                    };
                    map = new google.maps.Map(document.getElementById('map-canvas'),
                            mapOptions);

                    map.data.setStyle({
                        fillColor: 'blue'
                    });

                    //County boundary request
                    var countyRequest = {
                        state: "CA",
                        level: "county",
                        sublevel: true,
                        container: "state"
                    };

                    //Request the boundaries and attach them to the map
                    census.GEORequest(countyRequest, function(response) {
                        map.data.addGeoJson(response);
                    });

                    //Create a popup
                    var popup = new google.maps.InfoWindow();

                    //Attach a listener for when a user clicks on a boundary
                    map.data.addListener('click', function(event) {
                        var lat = event.feature.getProperty("CENTLAT");
                        var lng = event.feature.getProperty("CENTLON");
                        var name = event.feature.getProperty("NAME");

                        var request = {
                            "lat": lat,
                            "lng": lng
                        };

                        farmersMarket.search(request, function(response) {
                            var html = "<h3>" + name + "</h3><br/>";
                            html+= "<ul>";
                            response.results.forEach(function (market) {
                                html+= "<li>" + market.marketname + "</li>";
                            });
                            html+= "</ul>";

                            popup.setContent(html);
                            popup.setPosition(event.latLng);
                            popup.open(map);
                        });
                    });
                }
        );
    </script>

</head>

<body>

		<div class="row clearfix">
			<div class="btn-group">
				  <button type="button" onclick="http://uscensusbureau.github.io/citysdk/guides/guidestemplate.html" class="btn btn-default">View the Guide</button>
				  <button type="button" class="active" onclick="#" class="btn btn-default">Source Code</button>
			</div>
		</div>



		<div>				
					<script src="https://gist.github.com/jmeisel/80c0fca8db827796018b.js"></script>
		</div>

</body>
