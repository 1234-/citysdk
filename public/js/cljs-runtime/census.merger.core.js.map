{"version":3,"sources":["census/merger/core.cljs"],"sourcesContent":["(ns census.merger.core\r\n  (:require\r\n    [cljs.core.async       :refer [>! <! chan promise-chan close! pipeline put!\r\n                                   to-chan take!]\r\n                           :refer-macros [go alt! go-loop]]\r\n    [cuerdas.core          :refer-macros [istr]\r\n                           :as s]\r\n    [net.cgrand.xforms     :as x]\r\n    [census.utils.core     :refer [URL-GEOKEYMAP xf<< educt<<\r\n                                   throw-err err-type ->args map-over-keys\r\n                                   amap-type $GET$]]))\r\n\r\n(comment\r\n  ;; NOTE: If you need to increase memory of Node in Shadow... Eval in REPL:\r\n  (shadow.cljs.devtools.api/node-repl {:node-args [\"--max-old-space-size=4096\"]}))\r\n  ;; or in Node: node --max-old-space-size=4096\r\n\r\n;(defn deep-merge-with-seq\r\n;  [& maps]\r\n;  (apply merge-with\r\n;         (fn [& args]\r\n;           (if (every? map? args)\r\n;             (apply deep-merge-with-seq args)\r\n;             (last args)))\r\n;         maps))\r\n\r\n; Examples ================================================\r\n\r\n;(def xf-deep-merge-seq (x/for [[_ maps] %] (apply deep-merge-with-seq maps)))\r\n;\r\n;(defn xf-remove-unmerged\r\n;  \"\r\n;  Transducer, which takes 2->3 keys that serve to filter a merged list of two\r\n;  maps to return a function, which returns a list of only those maps which have\r\n;  a key from both maps. The presence of both keys within the map signifies that\r\n;  the maps have merged. This ensures the returned list contains only the overlap\r\n;  between the two, i.e., excluding non-merged maps.\r\n;  \"\r\n;  [IDS]\r\n;  (xf<<\r\n;    (fn [rf acc this]\r\n;      (let [[[_ v]] (x/into [] this)]\r\n;        (if (not-any? nil? (map #(get-in v [:properties %]) IDS))\r\n;          (rf acc v)\r\n;          (rf acc))))))\r\n\r\n\r\n;; From MFikes\r\n;\r\n;(deftype Transfer [^:mutable v]\r\n;  IDeref\r\n;  (-deref [o]\r\n;    (let [r v]\r\n;      (set! v nil)\r\n;      r)))\r\n;\r\n;(defn map'\r\n;  [f transfer]\r\n;  (lazy-seq\r\n;    (when-let [s (seq @transfer)]\r\n;      (cons (f (first s))\r\n;            (map' f (Transfer.\r\n;                      (rest s)))))))\r\n\r\n\r\n\r\n;      e    e                             /\r\n;     d8b  d8b      e88~~8e  888-~\\ e88~88e  e88~~8e  888-~\\\r\n;    d888bdY88b    d888  88b 888    888 888 d888  88b 888\r\n;   / Y88Y Y888b   8888__888 888    \"88_88\" 8888__888 888\r\n;  /   YY   Y888b  Y888    , 888     /      Y888    , 888\r\n; /          Y888b  \"88___/  888    Cb       \"88___/  888\r\n;                                    Y8\"\"8D\r\n\r\n\r\n;\r\n;(defn group-by-keys\r\n;  \"\r\n;  Implementation of `group-by` (produces a map) via @cgrand's `xforms`\r\n;  See 'Usage': https://github.com/cgrand/xforms#usage\r\n;  \"\r\n;  [coll]\r\n;  (into {} (x/by-key keys (x/into [])) coll))\r\n;\r\n;\r\n;(defn xf-merge->filter\r\n;  [IDS]\r\n;  (comp xf-deep-merge-seq\r\n;        (xf-remove-unmerged IDS)))\r\n        ;(map clj->js)\r\n        ;(map js/JSON.stringify)))\r\n\r\n\r\n;  888~~  888 Y88b    /      e    e      888~~\r\n;  888___ 888  Y88b  /      d8b  d8b     888___\r\n;  888    888   Y88b/      d888bdY88b    888\r\n;  888    888   /Y88b     / Y88Y Y888b   888\r\n;  888    888  /  Y88b   /   YY   Y888b  888\r\n;  888    888 /    Y88b /          Y888b 888___\r\n\r\n\r\n;; from @CGrand\r\n\r\n\r\n;(defn deep-merge-with-c\r\n;  \"\r\n;  From @cgrand: Recursively merges two maps together along matching key paths.\r\n;  \"\r\n;  [a b]\r\n;  (if (map? a)\r\n;    (into a (x/for [[k v] b] [k (deep-merge-with-2 (a k) v)]))\r\n;    b))\r\n\r\n(defn deep-merge-a-coll\r\n  [maps]\r\n  (apply merge-with\r\n         (fn [& args]\r\n           (if (every? map? args)\r\n             (deep-merge-a-coll args)\r\n             (last args)))\r\n         maps))\r\n\r\n;(defn group-and-merge\r\n;  \"\r\n;  From @cgrand\r\n;  \"\r\n;  [coll1 coll2]\r\n;  (let [coll1-by-key (into {} (for [x coll1] [(keys x) x]))\r\n;        coll2-by-key (into {} (for [x coll2] [(keys x) x]))]\r\n;    (vals (deep-merge-with coll1-by-key coll2-by-key))))\r\n\r\n\r\n(defn remove-unmerged\r\n  \"\r\n  Transducer, which takes 2->3 keys that serve to filter a merged list of two\r\n  maps to return a function, which returns a list of only those maps which have\r\n  a key from both maps. The presence of both keys within the map signifies that\r\n  the maps have merged. This ensures the returned list contains only the overlap\r\n  between the two, i.e., excluding non-merged maps.\r\n  \"\r\n  [IDS]\r\n  (fn [m]\r\n    (let [[[_ v]] (x/into [] m)]\r\n      (if (not-any? nil? (map (get v :properties) IDS))\r\n        v))))\r\n\r\n\r\n(defn xf<-Grands->JS\r\n  [IDS]\r\n  (comp (x/into [])\r\n        (map deep-merge-a-coll)\r\n        (map (remove-unmerged IDS))\r\n        (map clj->js)))\r\n\r\n\r\n(defn xf-Grands-M->JSON\r\n  \"\r\n  Implementation of `group-by` (produces a map) via @cgrand's `xforms`\r\n  See 'Usage': https://github.com/cgrand/xforms#usage\r\n  \"\r\n  [IDS]\r\n  (comp (x/by-key keys (xf<-Grands->JS IDS))\r\n        (remove   (fn [[_ v]] (nil? v)))\r\n        (map      #(get % 1))\r\n        (map      js/JSON.stringify)))\r\n\r\n(defn I=OE-M-spooler\r\n  [$g$ =arg= cfgs]\r\n  (fn [=O= =E=]\r\n    (let [=args= (promise-chan)]\r\n      (go (>! =args= (<! =arg=))\r\n          (let [=cfg= (chan 1)\r\n                $ids$ (atom [])]\r\n            (loop [todo cfgs\r\n                   [cfg ?=$g$] (first cfgs)\r\n                   acc (transient [])]\r\n              (if (nil? (first todo))\r\n                (do (prn \"Working on it ...\")\r\n                    (>! =O=\r\n                        (as-> (persistent! acc) coll\r\n                              (reduce concat coll)\r\n                              (eduction (xf-Grands-M->JSON @$ids$) coll)\r\n                              (s/join \",\" coll)\r\n                              (istr \"{\\\"type\\\":\\\"FeatureCollection\\\",\\\"features\\\":[~{coll}]}\")))\r\n                    (close! =cfg=)\r\n                    (close! =args=))\r\n                (do (if ?=$g$\r\n                        ((cfg $g$) =args= =cfg=)\r\n                        (cfg =args= =cfg=))\r\n                    (let [{:keys [getter url xform filter-id]} (<! =cfg=)]\r\n                      (if getter\r\n                        (let [=xform= (chan 1 xform)\r\n                              =err=   (chan 1 (map throw-err))]\r\n                          (swap! $ids$ conj filter-id)\r\n                          (getter (to-chan [url]) =xform= =err=)\r\n                          (alt! =xform= ([data] (do (close! =xform=)\r\n                                                    (close! =err=)\r\n                                                    (recur (rest todo)\r\n                                                           (second todo)\r\n                                                           (conj! acc data))))\r\n                                =err=    ([err] (do (close! =xform=)\r\n                                                    (close! =err=)\r\n                                                    (>! =E= err))))))\r\n                      (do (>! =E= cfg)\r\n                          (close! =cfg=)\r\n                          (close! =O=)\r\n                          (close! =args=) ; Close up shop...\r\n                          (close! =E=)))))))))))\r\n\r\n\r\n\r\n"],"mappings":"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","names":["census.merger.core/deep-merge-a-coll","cljs.core.apply.cljs$core$IFn$_invoke$arity$3","cljs.core/merge-with","cljs.core/every?","cljs.core/map?","args","cljs.core/last","maps","census.merger.core/remove-unmerged","cljs.core.nth.cljs$core$IFn$_invoke$arity$3","vec__31618","vec__31621","net.cgrand.xforms.into.cljs$core$IFn$_invoke$arity$2","m","cljs.core/not-any?","cljs.core/nil?","cljs.core.map.cljs$core$IFn$_invoke$arity$2","cljs.core.get.cljs$core$IFn$_invoke$arity$2","v","IDS","census.merger.core/xf<-Grands->JS","cljs.core.comp.cljs$core$IFn$_invoke$arity$variadic","net.cgrand.xforms.into.cljs$core$IFn$_invoke$arity$1","cljs.core.map.cljs$core$IFn$_invoke$arity$1","cljs.core/clj->js","census.merger.core/xf-Grands-M->JSON","net.cgrand.xforms.by_key.cljs$core$IFn$_invoke$arity$2","cljs.core/keys","cljs.core.remove.cljs$core$IFn$_invoke$arity$1","p__31631","vec__31632","p1__31629#","js/JSON.stringify","census.merger.core/I=OE-M-spooler","cljs.core.async.promise_chan.cljs$core$IFn$_invoke$arity$0","cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1","cljs.core.async.impl.dispatch/run","state_31800","state_val_31801","inst_31665","statearr-31802","statearr-31803","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","inst_31694","statearr-31804","inst_31715","inst_31750","inst_31724","inst_31726","inst_31657","inst_31659","inst_31758","inst_31761","inst_31762","inst_31763","statearr-31806","inst_31760","inst_31658","inst_31759","statearr-31807","cljs.core.async.impl.ioc-helpers/take!","statearr-31808","inst_31666","statearr-31810","inst_31664","inst_31667","statearr-31811","statearr-31812","statearr-31813","statearr-31814","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","inst_31752","inst_31777","statearr-31815","statearr-31816","statearr-31817","inst_31783","statearr-31818","inst_31775","cljs.core/not","inst_31696","statearr-31819","inst_31697","statearr-31820","statearr-31821","inst_31718","statearr-31822","inst_31720","inst_31722","inst_31721","inst_31719","statearr-31823","statearr-31824","statearr-31825","inst_31781","statearr-31826","inst_31785","inst_31670","cljs.core/deref","inst_31641","inst_31672","inst_31673","inst_31671","inst_31674","inst_31675","statearr-31827","inst_31669","cljs.core.async.impl.ioc-helpers/put!","inst_31679","inst_31766","statearr-31828","statearr-31829","statearr-31830","inst_31788","statearr-31831","inst_31751","statearr-31832","inst_31636","statearr-31836","inst_31691","inst_31639","cljs.core/PersistentVector","inst_31640","inst_31650","inst_31655","inst_31656","statearr-31837","inst_31652","inst_31638","inst_31653","statearr-31838","inst_31725","inst_31728","inst_31729","inst_31730","inst_31731","inst_31746","inst_31747","statearr-31839","inst_31732","inst_31727","cljs.core.async/ioc-alts!","inst_31748","statearr-31840","statearr-31841","inst_31710","statearr-31842","inst_31689","statearr-31843","inst_31682","inst_31681","statearr-31844","inst_31683","cljs.core.async.impl.ioc-helpers/return-chan","inst_31798","inst_31702","cljs.core/PROTOCOL_SENTINEL","inst_31704","inst_31703","inst_31705","inst_31706","statearr-31845","statearr-31846","statearr-31847","inst_31753","statearr-31848","statearr-31849","inst_31713","statearr-31854","statearr-31855","statearr-31856","inst_31773","inst_31772","inst_31771","inst_31686","statearr-31858","inst_31687","statearr-31859","statearr-31861","inst_31791","inst_31792","inst_31790","inst_31793","statearr-31862","inst_31794","statearr-31863","inst_31796","statearr-31864","state-machine__16489__auto__","switch__16488__auto__","cljs.core/keyword-identical?","result__16491__auto__","e31865","js/Object","statearr-31866","ex__16492__auto__","cljs.core.async.impl.ioc-helpers/process-exception","ret-value__16490__auto__","f__16664__auto__","statearr-31867","cljs.core.async.impl.ioc-helpers/USER-START-IDX","c__16663__auto__","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","state__16665__auto__","=args=","=arg=","cljs.core.atom.cljs$core$IFn$_invoke$arity$1","cfgs","cljs.core/first","cljs.core/transient","cljs.core.prn.cljs$core$IFn$_invoke$arity$variadic","=O=","cljs.core/persistent!","cljs.core.reduce.cljs$core$IFn$_invoke$arity$2","cljs.core/concat","cljs.core.eduction.cljs$core$IFn$_invoke$arity$variadic","cuerdas.core.join.cljs$core$IFn$_invoke$arity$2","cljs.core.async/close!","$g$","cljs.core.async.chan.cljs$core$IFn$_invoke$arity$2","census.utils.core/throw-err","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3","cljs.core/conj","cljs.core.async/to-chan","cljs.core/rest","cljs.core/second","cljs.core.conj_BANG_.cljs$core$IFn$_invoke$arity$2","=E="]}